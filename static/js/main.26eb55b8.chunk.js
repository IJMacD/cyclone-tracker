(window["webpackJsonpcyclone-track"]=window["webpackJsonpcyclone-track"]||[]).push([[0],{11:function(t,e,n){t.exports=n(19)},16:function(t,e,n){},18:function(t,e,n){},19:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(5),o=n.n(a),l=(n(16),n(1)),c=n.n(l),u=n(3),s=n(6),h=n(7),f=n(9),y=n(8),v=n(10),d=n(2);var m=function(){var t=Object(i.useState)({}),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(i.useRef)();return Object(i.useLayoutEffect)(function(){if(a.current){var t=function(){return window.requestAnimationFrame(function(){return r(function(t){var e=t.getBoundingClientRect();return{width:e.width,height:e.height,top:"x"in e?e.x:e.top,left:"y"in e?e.y:e.left,x:"x"in e?e.x:e.left,y:"y"in e?e.y:e.top,right:e.right,bottom:e.bottom}}(a.current))})};return t(),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}},[a.current]),[a,n]},p=22.3025,w=114.174167,g=.033,x=1e3,b=1e3;function S(t){var e=t.myLocation,i=t.cyclones,a=r.a.useRef(),o=m(),l=Object(d.a)(o,2),s=l[0],h=l[1],f=h.width,y=void 0===f?x:f,v=h.height,S=void 0===v?b:v,L=g*y/2,j=g*S/2,O={minLat:p-j,minLon:w-L,maxLat:p+j,maxLon:w+L,width:y,height:S},W=r.a.useState(),F=Object(d.a)(W,2),C=F[0],N=F[1];return r.a.useEffect(function(){if(s.current){var t=s.current.getContext("2d");if(t.clearRect(0,0,O.width,O.height),e){var n=k(e,O),r=n.x,a=n.y;t.beginPath(),t.ellipse(r,a,2,2,0,0,2*Math.PI),t.fillStyle="#FF0000",t.fill()}var o=!0,l=!1,c=void 0;try{for(var u,h=i[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var f=u.value,y=f.track.find(function(t){return"A"===t.type});if(y){var v=k(y,O),d=v.x,m=v.y;t.beginPath();var p=2*y.windspeed;t.ellipse(d,m,p,p,0,0,2*Math.PI),t.fillStyle="#C0C0C0",t.globalAlpha=.5,t.fill(),t.globalAlpha=1}E(t,O,f.track.filter(function(t){return"P"===t.type||"A"===t.type}),"#000000",4),E(t,O,f.track.filter(function(t){return"F"===t.type||"A"===t.type}),"#808080",4);var w=!0,g=!1,x=void 0;try{for(var b,S=f.track[Symbol.iterator]();!(w=(b=S.next()).done);w=!0){var L=b.value;if(L.windspeed){t.beginPath();var j=k(L,O),W=j.x,F=j.y,C=.1*L.windspeed;t.ellipse(W,F,C,C,0,0,2*Math.PI),t.fillStyle="P"===L.type?"#000000":"F"===L.type?"#808080":"#800080",t.fill()}}}catch(M){g=!0,x=M}finally{try{w||null==S.return||S.return()}finally{if(g)throw x}}if(y){var N=k(y,O),P=N.x,A=N.y;t.strokeStyle="#FFFFFF",t.fillStyle="#800080";var I=y.time.substring(0,13);t.strokeText(I,P,A+30),t.fillText(I,P,A+30);var T="".concat(y.windspeed," km/h");t.strokeText(T,P,A+42),t.fillText(T,P,A+42)}}}catch(M){l=!0,c=M}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}}},[e,i,O.width,O.height]),r.a.useEffect(function(){function t(){return(t=Object(u.a)(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(3).then(n.t.bind(null,20,3));case 2:e=t.sent,N(e);case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]),r.a.useEffect(function(){if(a.current&&C){var t=a.current.getContext("2d");t.clearRect(0,0,x,b);var e=!0,n=!1,i=void 0;try{for(var r,o=C.features[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var l=r.value;if("LineString"===l.geometry.type)E(t,O,l.geometry.coordinates.map(function(t){return{latitude:t[1],longitude:t[0]}}),"#80C080",1);else if("MultiLineString"===l.geometry.type){var c=!0,u=!1,s=void 0;try{for(var h,f=l.geometry.coordinates[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var y=h.value;E(t,O,y.map(function(t){return{latitude:t[1],longitude:t[0]}}),"#80C080",1)}}catch(v){u=!0,s=v}finally{try{c||null==f.return||f.return()}finally{if(u)throw s}}}}}catch(v){n=!0,i=v}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}},[C,O.width,O.height]),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("canvas",{ref:a,width:O.width,height:O.height,style:{width:"100vw",height:"100vh",position:"absolute",zIndex:-1}}),r.a.createElement("canvas",{ref:s,width:O.width,height:O.height,style:{width:"100vw",height:"100vh"}}))}function k(t,e){return{x:(t.longitude-e.minLon)/(e.maxLon-e.minLon)*e.width,y:e.height-(t.latitude-e.minLat)/(e.maxLat-e.minLat)*e.height}}function E(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000000",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;t.strokeStyle=i,t.lineWidth=r,t.beginPath();var a=!0,o=!0,l=!1,c=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var h=k(u.value,e),f=h.x,y=h.y;a?t.moveTo(f,y):t.lineTo(f,y),a=!1}}catch(v){l=!0,c=v}finally{try{o||null==s.return||s.return()}finally{if(l)throw c}}t.stroke()}"N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW".split(" ");n(18);var L=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(f.a)(this,Object(y.a)(e).call(this,t))).state={cyclones:[],myLocation:null},n}return Object(v.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;navigator.geolocation.getCurrentPosition(function(e){var n=e.coords;t.setState({myLocation:n})}),this.timeout=setInterval(this.fetchData.bind(this),9e5),this.fetchData()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timeout),this.timeout=null}},{key:"fetchData",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.i-learner.edu.hk/weather/api/v2/cyclone");case 2:return e=t.sent,t.next=5,e.json();case 5:n=t.sent,this.timeout&&this.setState({cyclones:n});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("ul",{style:{position:"fixed"}},this.state.cyclones.map(function(t){return r.a.createElement("li",{key:t.id},t.name," ",t.distance,"km ",t.bearing)})),r.a.createElement(S,{cyclones:this.state.cyclones,myLocation:this.state.myLocation}))}}]),e}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.26eb55b8.chunk.js.map